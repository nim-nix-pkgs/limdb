<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>LimDB</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);

  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark') {
      toggleSwitch.checked = true;
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">LimDB</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    <li>
      <a href="theindex.html">Index</a>
    </li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="whyqmark_toc" href="#whyqmark">Why?</a></li>
<li><a class="reference" id="simple-usage_toc" href="#simple-usage">Simple Usage</a></li>
<li><a class="reference" id="transactions_toc" href="#transactions">Transactions</a></li>
<li><a class="reference" id="iterators_toc" href="#iterators">Iterators</a></li>
<li><a class="reference" id="named-databases_toc" href="#named-databases">Named Databases</a></li>
<li><a class="reference" id="limitations_toc" href="#limitations">Limitations</a></li>
<li><a class="reference" id="improvement-areas-of-interest_toc" href="#improvement-areas-of-interest">Improvement Areas Of Interest</a></li>
<li><a class="reference" id="why-is-it-called-limdbqmark_toc" href="#why-is-it-called-limdbqmark">Why is it called LimDB?</a></li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#Blob"
    title="Blob = Val">Blob</a></li>
  <li><a class="reference" href="#Database"
    title="Database = object
  env*: LMDBEnv
  dbi*: Dbi">Database</a></li>
  <li><a class="reference" href="#Transaction"
    title="Transaction = object
  txn*: LMDBTxn
  dbi*: Dbi">Transaction</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">[]
      <li><a class="reference" href="#%5B%5D%2CDatabase%2Cstring"
    title="`[]`(db: Database; key: string): string">[],<wbr>Database,<wbr>string</a></li>
  <li><a class="reference" href="#%5B%5D%2CTransaction%2Cstring"
    title="`[]`(t: Transaction; key: string): string">[],<wbr>Transaction,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">[]=
      <li><a class="reference" href="#%5B%5D%3D%2CDatabase%2Cstring%2Cstring"
    title="`[]=`(d: Database; key, value: string)">[]=,<wbr>Database,<wbr>string,<wbr>string</a></li>
  <li><a class="reference" href="#%5B%5D%3D%2CTransaction%2Cstring%2Cstring"
    title="`[]=`(t: Transaction; key, value: string)">[]=,<wbr>Transaction,<wbr>string,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">clear
      <li><a class="reference" href="#clear%2CDatabase"
    title="clear(db: Database)">clear,<wbr>Database</a></li>

  </ul>
  <ul class="simple nested-toc-section">copy
      <li><a class="reference" href="#copy%2CDatabase%2Cstring"
    title="copy(db: Database; filename: string)">copy,<wbr>Database,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">del
      <li><a class="reference" href="#del%2CDatabase%2Cstring%2Cstring"
    title="del(db: Database; key, value: string)">del,<wbr>Database,<wbr>string,<wbr>string</a></li>
  <li><a class="reference" href="#del%2CDatabase%2Cstring"
    title="del(db: Database; key: string)">del,<wbr>Database,<wbr>string</a></li>
  <li><a class="reference" href="#del%2CTransaction%2Cstring%2Cstring"
    title="del(t: Transaction; key, value: string)">del,<wbr>Transaction,<wbr>string,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">fromBlob
      <li><a class="reference" href="#fromBlob%2CVal"
    title="fromBlob(b: Blob): string">fromBlob,<wbr>Val</a></li>

  </ul>
  <ul class="simple nested-toc-section">hasKey
      <li><a class="reference" href="#hasKey%2CDatabase%2Cstring"
    title="hasKey(db: Database; key: string): bool">hasKey,<wbr>Database,<wbr>string</a></li>
  <li><a class="reference" href="#hasKey%2CTransaction%2Cstring"
    title="hasKey(t: Transaction; key: string): bool">hasKey,<wbr>Transaction,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">initDatabase
      <li><a class="reference" href="#initDatabase%2CDatabase%2Cstring"
    title="initDatabase(db: Database; name = &quot;&quot;): Database">initDatabase,<wbr>Database,<wbr>string</a></li>
  <li><a class="reference" href="#initDatabase%2Cstring%2Cstring%2Cint"
    title="initDatabase(filename = &quot;&quot;; name = &quot;&quot;; maxdbs = 255): Database">initDatabase,<wbr>string,<wbr>string,<wbr>int</a></li>

  </ul>
  <ul class="simple nested-toc-section">initTransaction
      <li><a class="reference" href="#initTransaction%2CDatabase"
    title="initTransaction(db: Database): Transaction">initTransaction,<wbr>Database</a></li>

  </ul>
  <ul class="simple nested-toc-section">len
      <li><a class="reference" href="#len%2CDatabase"
    title="len(db: Database): int">len,<wbr>Database</a></li>

  </ul>
  <ul class="simple nested-toc-section">open
      <li><a class="reference" href="#open%2CDatabase%2Cstring"
    title="open(db: Database; name: string): Dbi">open,<wbr>Database,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">toBlob
      <li><a class="reference" href="#toBlob%2Cstring"
    title="toBlob(s: string): Blob">toBlob,<wbr>string</a></li>

  </ul>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#15" id="65">Iterators</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">keys
      <li><a class="reference" href="#keys.i%2CDatabase"
    title="keys(db: Database): string">keys.i,<wbr>Database</a></li>
  <li><a class="reference" href="#keys.i%2CTransaction"
    title="keys(t: Transaction): string">keys.i,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">mpairs
      <li><a class="reference" href="#mpairs.i%2CDatabase"
    title="mpairs(db: Database): (string, var string)">mpairs.i,<wbr>Database</a></li>
  <li><a class="reference" href="#mpairs.i%2CTransaction"
    title="mpairs(t: Transaction): (string, var string)">mpairs.i,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">mvalues
      <li><a class="reference" href="#mvalues.i%2CDatabase"
    title="mvalues(db: Database): var string">mvalues.i,<wbr>Database</a></li>
  <li><a class="reference" href="#mvalues.i%2CTransaction"
    title="mvalues(t: Transaction): var string">mvalues.i,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">pairs
      <li><a class="reference" href="#pairs.i%2CDatabase"
    title="pairs(db: Database): (string, string)">pairs.i,<wbr>Database</a></li>
  <li><a class="reference" href="#pairs.i%2CTransaction"
    title="pairs(t: Transaction): (string, string)">pairs.i,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">values
      <li><a class="reference" href="#values.i%2CDatabase"
    title="values(db: Database): string">values.i,<wbr>Database</a></li>
  <li><a class="reference" href="#values.i%2CTransaction"
    title="values(t: Transaction): string">values.i,<wbr>Transaction</a></li>

  </ul>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#18" id="68">Templates</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">clear
      <li><a class="reference" href="#clear.t%2CTransaction"
    title="clear(t: Transaction)">clear.t,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">close
      <li><a class="reference" href="#close.t%2CDatabase"
    title="close(db: Database)">close.t,<wbr>Database</a></li>

  </ul>
  <ul class="simple nested-toc-section">commit
      <li><a class="reference" href="#commit.t%2CTransaction"
    title="commit(t: Transaction)">commit.t,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">contains
      <li><a class="reference" href="#contains.t%2CDatabase%2Cstring"
    title="contains(db: Database; key: string): bool">contains.t,<wbr>Database,<wbr>string</a></li>
  <li><a class="reference" href="#contains.t%2CTransaction%2Cstring"
    title="contains(t: Transaction; key: string): bool">contains.t,<wbr>Transaction,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">del
      <li><a class="reference" href="#del.t%2CTransaction%2Cstring"
    title="del(t: Transaction; key: string)">del.t,<wbr>Transaction,<wbr>string</a></li>

  </ul>
  <ul class="simple nested-toc-section">len
      <li><a class="reference" href="#len.t%2CTransaction"
    title="len(t: Transaction): int">len.t,<wbr>Transaction</a></li>

  </ul>
  <ul class="simple nested-toc-section">reset
      <li><a class="reference" href="#reset.t%2CTransaction"
    title="reset(t: Transaction)">reset.t,<wbr>Transaction</a></li>

  </ul>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"><p>Fast, in-process key-value store with a table-like interface persisted to disk using lmdb.</p>

<h1><a class="toc-backref" id="whyqmark" href="#whyqmark">Why?</a></h1><p>Memory-mapped files are one of the fastest ways to store data but are not safe to access concurrently. Lmdb is a proven and mature to solution to that problem, offering full compliance to ACID3, a common standard for database reliability, while keeping most of the speed.</p>
<p>Leveraging the excellent nim-lmdb interface, LimDB makes a larg-ish sub-set of lmdb features available in an interface familiar to Nim users who have experience with a table.</p>
<p>While programming with LimDB feels like using a table, it is still very much lmdb. Some common boilerplate is automated and LimDB is clever about bundling lmdb's moving parts, but there are no bolted-on bits or obscuring of lmdb's behavior.</p>

<h1><a class="toc-backref" id="simple-usage" href="#simple-usage">Simple Usage</a></h1><p>Provide LimDB with a local storage directory and then use it like you would use a table. After inserting the element, it's on disk an can be accessed even after the program is restarted, or concurrently by different threads or processes.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>  <span class="Comment"># that's it, foo -&gt; bar is now on disk</span>
<span class="Identifier">echo</span> <span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>     <span class="Comment"># prints bar</span></pre><p>Now if you comment out the write, you can run the program again and read the value off disk</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Comment"># db[&quot;foo&quot;] = &quot;bar&quot;</span>
<span class="Identifier">echo</span> <span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>  <span class="Comment"># also prints &quot;bar&quot;</span></pre><p>That's it. If you just need to quickly save some data, you can stop reading here and start programming.</p>

<h1><a class="toc-backref" id="transactions" href="#transactions">Transactions</a></h1><p>Sometimes you need to read or write to the database in several related ways that are best done as a group. This is a common database concept and most databases support them. Reads and writes grouped in this way are gauranteed not to be affected by other writes happening at the same time. Also, all writes are completed at once after the transaction, and if there is an error, no writes happen at all. This goes a long way towards not messing up your data.</p>
<p>A transaction is started using <tt class="docutils literal"><span class="pre"><span class="Identifier">initTransaction</span></span></tt>, and stopped with either <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> or <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt>. Use <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> if you only read data, or you want to throw away all writes. Use <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> to actually perform all the writes.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;buz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another buz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>  <span class="Comment"># foo and bar remain unchanged</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">echo</span> <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span>
<span class="Identifier">echo</span> <span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;bar&quot;</span><span class="Punctuation">]</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>  <span class="Comment"># read-only transactions are always reset</span></pre><div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
Make sure to reset transactions when exceptions are thrown. If you use a database object directly without calling <tt class="docutils literal"><span class="pre"><span class="Identifier">initTransaction</span></span></tt>, LimDB handles this for you.</div>

<h1><a class="toc-backref" id="iterators" href="#iterators">Iterators</a></h1><p>While you can access any data using the keys, you might want all of the data or not know the keys. You can use the usual <tt class="docutils literal"><span class="pre"><span class="Identifier">keys</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">values</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">pairs</span></span></tt> iterators with a LimDB. They can be used standalone on a database or as part of a transaciton.</p>
<p>You can also use <tt class="docutils literal"><span class="pre"><span class="Identifier">mvalues</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">mpairs</span></span></tt> to modify values on the go.</p>
<blockquote><p><pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">t</span><span class="Punctuation">[</span><span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;buz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">for</span> <span class="Identifier">key</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">keys</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">key</span>
<span class="Comment"># prints:</span>
<span class="Comment"># foo</span>
<span class="Comment"># fuz</span>

<span class="Keyword">let</span> <span class="Identifier">t</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initTransaction</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">values</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">value</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">reset</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Comment"># prints:</span>
<span class="Comment"># bar</span>
<span class="Comment"># buz</span>

<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;$# -&gt; $#&quot;</span> <span class="Operator">%</span> <span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span><span class="Punctuation">)</span>

<span class="Comment"># prints:</span>
<span class="Comment"># foo -&gt; bar</span>
<span class="Comment"># fuz -&gt; buz</span>

<span class="Keyword">for</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">mvalues</span><span class="Punctuation">:</span>
  <span class="Keyword">if</span> <span class="Identifier">value</span> <span class="Operator">==</span> <span class="StringLit">&quot;fuz&quot;</span><span class="Punctuation">:</span>
    <span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">&quot;buzz&quot;</span>

<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">initTransaction</span>
<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">mpairs</span><span class="Punctuation">:</span>
  <span class="Keyword">if</span> <span class="Identifier">key</span> <span class="Operator">==</span> <span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">:</span>
    <span class="Identifier">value</span> <span class="Operator">=</span> <span class="StringLit">&quot;barz&quot;</span>
<span class="Identifier">t</span><span class="Operator">.</span><span class="Identifier">commit</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">for</span> <span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span> <span class="Keyword">in</span> <span class="Identifier">db</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;$# -&gt; $#&quot;</span> <span class="Operator">%</span> <span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span><span class="Punctuation">)</span>

<span class="Comment"># prints:</span>
<span class="Comment"># foo -&gt; barz</span>
<span class="Comment"># fuz -&gt; buzz</span></pre></p></blockquote>

<h1><a class="toc-backref" id="named-databases" href="#named-databases">Named Databases</a></h1><p>More than one database can be placed in the same storage location. No keys or values are shared between databases, so the key foo will remain empty in database B if it is set in database A.</p>
<p>To access more than one database in the same Nim program, create an additional database from an existing one. The connection and storage location will be shared.</p>
<p>The default database, the one used in the examples above, also has a name, an empty string <tt class="docutils literal"><span class="pre"><span class="StringLit">&quot;&quot;</span></span></tt>.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">limdb</span>
<span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myDirectory&quot;</span><span class="Punctuation">)</span>

<span class="Keyword">let</span> <span class="Identifier">db2</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">initDatabase</span><span class="Punctuation">(</span><span class="StringLit">&quot;myName&quot;</span><span class="Punctuation">)</span>

<span class="Identifier">db</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;bar&quot;</span>
<span class="Identifier">db2</span><span class="Punctuation">[</span><span class="StringLit">&quot;foo&quot;</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="StringLit">&quot;another bar</span></pre><p>Database objects created from other database objects do not differ from ones created directly from a filename.</p>
<p>Only one database may be initialized from the same storage location, additional ones can be created from it.</p>
<div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
If you use named databases, their names will appear as keys in the default database, The one named empty string <tt class="docutils literal"><span class="pre"><span class="StringLit">&quot;&quot;</span></span></tt>. In this case it is usually best not to use the default database for anything else, and iterate over the default databases' keys to get a list of named databases.</div>

<h1><a class="toc-backref" id="limitations" href="#limitations">Limitations</a></h1><p>Only strings are supported as data types, for now. In order to save other data types, they can be serialized to strings.</p>

<h1><a class="toc-backref" id="improvement-areas-of-interest" href="#improvement-areas-of-interest">Improvement Areas Of Interest</a></h1><ul class="simple"><li>Use generics to support any data type that a <tt class="docutils literal"><span class="pre"><span class="Identifier">toBlob</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">fromBlob</span></span></tt> can be written for. Possibly keep string versions as a shortcut.</li>
<li>Use Nim views to provide an alternative interface allowing safe zero-copy data access in with Nim data types (lmdb itself does not copy data when accessing)</li>
<li>Useful iterators: <tt class="docutils literal"><span class="pre"><span class="Identifier">keysFrom</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">keysBetween</span></span></tt>, other common usage of lmdb cursors</li>
<li>Map lmdb multipe values per key feature to something Nimish, perhaps iterators or seqs</li>
</ul>

<h1><a class="toc-backref" id="why-is-it-called-limdbqmark" href="#why-is-it-called-limdbqmark">Why is it called LimDB?</a></h1><p>LimDB was originally named LimrodDB after the ancient king Nimrod's younger sibling, Limrod, who didn't make it into the history books because he was short. It was later renamed LimDB for marketing reasons.</p>
<p>By a wild coincidence, it also sounds a little like a vaguely pleasing jumble of Nim and LMDB.</p>
</p>
  <div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="Blob"></a>
<dt><pre><a href="limdb.html#Blob"><span class="Identifier">Blob</span></a> <span class="Other">=</span> <span class="Identifier">Val</span></pre></dt>
<dd>

A variable-length collection of bytes that can be used as either a key or value. This is LMDB's native storage type- a block of memory. <tt class="docutils literal"><span class="pre"><span class="Identifier">string</span></span></tt> types are converted automatically, and conversion for other data types can be added by adding <tt class="docutils literal"><span class="pre"><span class="Identifier">fromBlob</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">toBlob</span></span></tt> for a type.

</dd>
<a id="Database"></a>
<dt><pre><a href="limdb.html#Database"><span class="Identifier">Database</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">env</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">LMDBEnv</span>
  <span class="Identifier">dbi</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Dbi</span>
</pre></dt>
<dd>

A key-value database in a memory-mapped on-disk storage location.

</dd>
<a id="Transaction"></a>
<dt><pre><a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">txn</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">LMDBTxn</span>
  <span class="Identifier">dbi</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">Dbi</span>
</pre></dt>
<dd>

A transaction may be created and reads or writes performed on it instead of directly on a database object. That way, reads or writes are not affected by other writes happening at the same time, and changes happen all at once at the end or not at all.

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="[]=,Database,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%3D%2CDatabase%2Cstring%2Cstring"><span class="Identifier">`[]=`</span></a><span class="Other">(</span><span class="Identifier">d</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Set a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>


</dd>
<a id="[]=,Transaction,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%3D%2CTransaction%2Cstring%2Cstring"><span class="Identifier">`[]=`</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>



</dd>
<a id="[],Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%2CDatabase%2Cstring"><span class="Identifier">`[]`</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Fetch a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="[],Transaction,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#%5B%5D%2CTransaction%2Cstring"><span class="Identifier">`[]`</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>



</dd>
<a id="clear,Database"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#clear%2CDatabase"><span class="Identifier">clear</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Remove all key-values pairs from the database, emptying it.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This creates and commits a transaction under the hood</div>


</dd>
<a id="copy,Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#copy%2CDatabase%2Cstring"><span class="Identifier">copy</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">filename</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Copy a database to a different directory. This also performs routine database maintenance so the resulting file with usually be smaller. This is best performed when no one is writing to the database directory.

</dd>
<a id="del,Database,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#del%2CDatabase%2Cstring%2Cstring"><span class="Identifier">del</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Delete a key-value pair in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>


</dd>
<a id="del,Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#del%2CDatabase%2Cstring"><span class="Identifier">del</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Deletes a value in the database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and commits a transaction under the hood</div>
<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
LMDB requires you to delete by key and value. This proc fetches the value for you, giving you the more familiar interface.</div>


</dd>
<a id="del,Transaction,string,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#del%2CTransaction%2Cstring%2Cstring"><span class="Identifier">del</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Delete a key-value pair

</dd>
<a id="fromBlob,Val"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#fromBlob%2CVal"><span class="Identifier">fromBlob</span></a><span class="Other">(</span><span class="Identifier">b</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Convert a chunk of data, key or value, to a string<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>


</dd>
<a id="hasKey,Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#hasKey%2CDatabase%2Cstring"><span class="Identifier">hasKey</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

See if a key exists without fetching any data in a transaction

</dd>
<a id="hasKey,Transaction,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#hasKey%2CTransaction%2Cstring"><span class="Identifier">hasKey</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

See if a key exists without fetching any data

</dd>
<a id="initDatabase,Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#initDatabase%2CDatabase%2Cstring"><span class="Identifier">initDatabase</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">name</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Open another database of a different name in an already-connected on-disk storage location.

</dd>
<a id="initDatabase,string,string,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#initDatabase%2Cstring%2Cstring%2Cint"><span class="Identifier">initDatabase</span></a><span class="Other">(</span><span class="Identifier">filename</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">;</span> <span class="Identifier">name</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">;</span> <span class="Identifier">maxdbs</span> <span class="Other">=</span> <span class="DecNumber">255</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">IOError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">WriteDirEffect</span><span class="Other">,</span> <span class="Identifier">ReadDirEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Connect to an on-disk storage location and open a database. If the path does not exist, a directory will be created.

</dd>
<a id="initTransaction,Database"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#initTransaction%2CDatabase"><span class="Identifier">initTransaction</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

<p>Start a transaction from a database.</p>
<p>Reads and writes on the transaction will reflect the same point in time and will not be affected by other writes.</p>
<p>After reads, <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> must be called on the transaction. After writes, <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> must be called to perform all of the writes, or <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> to perform none of them.</p>
<div class="admonition admonition-warning"><span class="admonition-warning-text"><b>Caution:</b></span>
Calling neither <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> nor <tt class="docutils literal"><span class="pre"><span class="Identifier">commit</span></span></tt> on a transaction can block database access. This commonly happens when an exception is raised.</div>


</dd>
<a id="len,Database"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#len%2CDatabase"><span class="Identifier">len</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Returns the number of key-value pairs in the database.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="open,Database,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#open%2CDatabase%2Cstring"><span class="Identifier">open</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Dbi</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>



</dd>
<a id="toBlob,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#toBlob%2Cstring"><span class="Identifier">toBlob</span></a><span class="Other">(</span><span class="Identifier">s</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="limdb.html#Blob"><span class="Identifier">Blob</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Convert a string to a chunk of data, key or value, for LMDB<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
If you want other data types than a string, implement this for the data type</div>


</dd>

</dl></div>
<div class="section" id="15">
<h1><a class="toc-backref" href="#15">Iterators</a></h1>
<dl class="item">
<a id="keys.i,Database"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#keys.i%2CDatabase"><span class="Identifier">keys</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all keys pairs in a database.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="keys.i,Transaction"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#keys.i%2CTransaction"><span class="Identifier">keys</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all keys in a database with a transaction

</dd>
<a id="mpairs.i,Database"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#mpairs.i%2CDatabase"><span class="Identifier">mpairs</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">string</span><span class="Other">,</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all key-value pairs in a database allowing the values to be modified<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="mpairs.i,Transaction"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#mpairs.i%2CTransaction"><span class="Identifier">mpairs</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">string</span><span class="Other">,</span> <span class="Keyword">var</span> <span class="Identifier">string</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all key-value pairs in a database with a transaction, allowing the values to be modified.

</dd>
<a id="mvalues.i,Database"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#mvalues.i%2CDatabase"><span class="Identifier">mvalues</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all values in a database allowing modification<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="mvalues.i,Transaction"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#mvalues.i%2CTransaction"><span class="Identifier">mvalues</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">var</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all values in a database with a transaction, allowing the values to be modified.

</dd>
<a id="pairs.i,Database"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#pairs.i%2CDatabase"><span class="Identifier">pairs</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all values in a database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="pairs.i,Transaction"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#pairs.i%2CTransaction"><span class="Identifier">pairs</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">string</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all key-value pairs in a database with a transaction.

</dd>
<a id="values.i,Database"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#values.i%2CDatabase"><span class="Identifier">values</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all values in a database<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This inits and resets a transaction under the hood</div>


</dd>
<a id="values.i,Transaction"></a>
<dt><pre><span class="Keyword">iterator</span> <a href="#values.i%2CTransaction"><span class="Identifier">values</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Iterate over all values in a database with a transaction.

</dd>

</dl></div>
<div class="section" id="18">
<h1><a class="toc-backref" href="#18">Templates</a></h1>
<dl class="item">
<a id="clear.t,Transaction"></a>
<dt><pre><span class="Keyword">template</span> <a href="#clear.t%2CTransaction"><span class="Identifier">clear</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span></pre></dt>
<dd>

Remove all key-values pairs from the database, emptying it.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
The size of the database will stay the same on-disk but won't grow until more data than was in there before is added. It will shrink if it is copied.</div>


</dd>
<a id="close.t,Database"></a>
<dt><pre><span class="Keyword">template</span> <a href="#close.t%2CDatabase"><span class="Identifier">close</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">)</span></pre></dt>
<dd>

Close the database directory. This will free up some memory and make all databases that were created from the same directory unavailable. This is not necessary for many use cases.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This creates and commits a transaction under the hood</div>


</dd>
<a id="commit.t,Transaction"></a>
<dt><pre><span class="Keyword">template</span> <a href="#commit.t%2CTransaction"><span class="Identifier">commit</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span></pre></dt>
<dd>

Commit a transaction. This writes all changes made in the transaction to disk.

</dd>
<a id="contains.t,Database,string"></a>
<dt><pre><span class="Keyword">template</span> <a href="#contains.t%2CDatabase%2Cstring"><span class="Identifier">contains</span></a><span class="Other">(</span><span class="Identifier">db</span><span class="Other">:</span> <a href="limdb.html#Database"><span class="Identifier">Database</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
<dd>

Alias for hasKey to support <tt class="docutils literal"><span class="pre"><span class="Keyword">in</span></span></tt> syntax in transactions

</dd>
<a id="contains.t,Transaction,string"></a>
<dt><pre><span class="Keyword">template</span> <a href="#contains.t%2CTransaction%2Cstring"><span class="Identifier">contains</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
<dd>

Alias for hasKey to support <tt class="docutils literal"><span class="pre"><span class="Keyword">in</span></span></tt> syntax

</dd>
<a id="del.t,Transaction,string"></a>
<dt><pre><span class="Keyword">template</span> <a href="#del.t%2CTransaction%2Cstring"><span class="Identifier">del</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">;</span> <span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span></pre></dt>
<dd>

Delete a value in a transaction<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
LMDB requires you to delete by key and value. This proc fetches the value for you, giving you the more familiar interface.</div>


</dd>
<a id="len.t,Transaction"></a>
<dt><pre><span class="Keyword">template</span> <a href="#len.t%2CTransaction"><span class="Identifier">len</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
<dd>

Returns the number of key-value pairs in the database.

</dd>
<a id="reset.t,Transaction"></a>
<dt><pre><span class="Keyword">template</span> <a href="#reset.t%2CTransaction"><span class="Identifier">reset</span></a><span class="Other">(</span><span class="Identifier">t</span><span class="Other">:</span> <a href="limdb.html#Transaction"><span class="Identifier">Transaction</span></a><span class="Other">)</span></pre></dt>
<dd>

Reset a transaction. This throws away all changes made in the transaction. After only reading in a transaction, reset it as well.<div class="admonition admonition-info"><span class="admonition-info-text"><b>Note:</b></span>
This is called <tt class="docutils literal"><span class="pre"><span class="Identifier">reset</span></span></tt> because that is a pleasant and familiar term for reverting changes. The term differs from LMDB though, under the hood this calles <tt class="docutils literal"><span class="pre"><span class="Identifier">mdb_abort</span></span></tt>, not <tt class="docutils literal"><span class="pre"><span class="Identifier">mdb_reset</span></span></tt>- the latter does something else not covered by LimDB.</div>


</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2022-06-12 22:42:41 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
